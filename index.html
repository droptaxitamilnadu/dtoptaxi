<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Droptaxi Tamilnadu | Premium Intercity</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Poppins',sans-serif;
}

body{
  background:linear-gradient(135deg,#0D47A1,#1565C0);
  min-height:100vh;
}

/* HEADER */
header{
  background:#fff;
  padding:12px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.logo{
  font-weight:800;
  font-size:18px;
}

.call-btn{
  background:#FFC107;
  padding:10px 18px;
  border-radius:30px;
  font-weight:700;
  text-decoration:none;
  color:#000;
}

/* HERO */
.hero{
  text-align:center;
  padding:30px 20px;
  color:#fff;
}

.hero h1{
  font-size:22px;
  font-weight:800;
}

/* CARD */
.booking-card{
  background:#fff;
  margin:0 15px 40px;
  padding:25px;
  border-radius:22px;
}

/* TOGGLE */
.toggle{
  display:flex;
  background:#f1f1f1;
  border-radius:40px;
  margin-bottom:20px;
}

.toggle button{
  flex:1;
  padding:12px;
  border:none;
  border-radius:40px;
  font-weight:700;
  background:transparent;
  cursor:pointer;
}

.toggle .active{
  background:#1f4fa3;
  color:#fff;
}

/* INPUT */
.field{
  margin-bottom:15px;
}

.field input,
.field select{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:1px solid #ddd;
  background:#f4f6f9;
  font-size:15px;
  outline:none;
}

.row{
  display:flex;
  gap:10px;
}

.row .field{
  flex:1;
}

/* BUTTON */
.book-btn{
  background:#FF6F00;
  color:#fff;
  width:100%;
  padding:16px;
  border:none;
  border-radius:16px;
  font-size:16px;
  font-weight:800;
  margin-top:10px;
  cursor:pointer;
}
</style>
</head>

<body>

<header>
  <div class="logo">Droptaxi Tamilnadu</div>
  <a href="tel:9045450000" class="call-btn">ðŸ“ž 9045450000</a>
</header>

<div class="hero">
  <h1>Premium Intercity Taxi Service Across Tamilnadu</h1>
</div>

<div class="booking-card">

  <!-- TOGGLE -->
  <div class="toggle">
    <button id="onewayBtn" class="active">One Way</button>
    <button id="roundBtn">Round Trip</button>
  </div>

  <!-- PICKUP -->
  <div class="field">
    <input type="text" id="pickup" placeholder="Pickup Location">
  </div>

  <!-- DROP -->
  <div class="field">
    <input type="text" id="drop" placeholder="Drop Location">
  </div>

  <!-- DATE TIME -->
  <div class="row">
    <div class="field">
      <input type="date" id="pickupDate">
    </div>
    <div class="field">
      <input type="time" id="pickupTime">
    </div>
  </div>

  <!-- RETURN DATE -->
  <div class="field" id="returnField" style="display:none;">
    <input type="date" id="returnDate" placeholder="Return Date">
  </div>

  <!-- NAME -->
  <div class="field">
    <input type="text" id="name" placeholder="Full Name">
  </div>

  <!-- PHONE -->
  <div class="row">
    <div class="field" style="flex:0.4;">
      <select id="code">
        <option value="+91">+91 India</option>
        <option value="+971">+971 UAE</option>
        <option value="+1">+1 USA</option>
        <option value="+44">+44 UK</option>
      </select>
    </div>
    <div class="field">
      <input type="tel" id="mobile" placeholder="Mobile Number">
    </div>
  </div>

  <button class="book-btn" onclick="checkFare()">CHECK FARE</button>

</div>

<!-- GOOGLE MAPS -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXnBk1mKSeIF5_UNsLejhqUYFIbJqMXZk&libraries=places"></script>

<script>
let tripType = "oneway";

const onewayBtn = document.getElementById("onewayBtn");
const roundBtn = document.getElementById("roundBtn");
const returnField = document.getElementById("returnField");

onewayBtn.onclick = () => {
  tripType = "oneway";
  onewayBtn.classList.add("active");
  roundBtn.classList.remove("active");
  returnField.style.display="none";
};

roundBtn.onclick = () => {
  tripType = "roundtrip";
  roundBtn.classList.add("active");
  onewayBtn.classList.remove("active");
  returnField.style.display="block";
};

/* GOOGLE AUTOCOMPLETE */
const options = {
  componentRestrictions: { country: "in" },
  fields: ["formatted_address"],
};
new google.maps.places.Autocomplete(document.getElementById("pickup"), options);
new google.maps.places.Autocomplete(document.getElementById("drop"), options);

/* AUTO DETECT LOCATION */
if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(pos=>{
    const geocoder = new google.maps.Geocoder();
    const latlng = {lat:pos.coords.latitude,lng:pos.coords.longitude};
    geocoder.geocode({location:latlng},(results,status)=>{
      if(status==="OK"){
        document.getElementById("pickup").value=results[0].formatted_address;
      }
    });
  });
}

/* CHECK FARE */
function checkFare(){

  const pickup = pickup.value.trim();
  const drop = drop.value.trim();
  const name = name.value.trim();
  const mobile = mobile.value.trim();
  const date = pickupDate.value;
  const time = pickupTime.value;
  const returnDate = document.getElementById("returnDate").value;

  if(!pickup||!drop||!name||!mobile||!date||!time){
    alert("Please fill all fields");
    return;
  }

  const service = new google.maps.DistanceMatrixService();

  service.getDistanceMatrix({
    origins:[pickup],
    destinations:[drop],
    travelMode:"DRIVING",
    unitSystem:google.maps.UnitSystem.METRIC
  },function(response,status){

    if(status!=="OK"){
      alert("Distance calculation failed");
      return;
    }

    const km = response.rows[0].elements[0].distance.value/1000;

    const data={
      pickup,drop,name,
      contact:document.getElementById("code").value+mobile,
      tripType,
      pickupDate:date,
      pickupTime:time,
      returnDate,
      km:km.toFixed(2),
      ip:"fetch"
    };

    /* SEND EMAIL */
    fetch("https://script.google.com/macros/s/AKfycbwd0rZ_Al2FtLa8DT97eRWzXyxpmXj3MoNNwxOQH_YoSix3gkR-sr5c6cOLe7gb6qiP/exec",{
      method:"POST",
      body:JSON.stringify(data)
    });

    /* REDIRECT */
    localStorage.setItem("bookingData",JSON.stringify(data));
    window.location="fare.html";
  });
}
</script>

</body>
</html>